"use strict";(self.webpackChunkclassic=self.webpackChunkclassic||[]).push([[979],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=i.createContext({}),l=function(e){var t=i.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return i.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=l(n),h=r,m=d["".concat(c,".").concat(h)]||d[h]||u[h]||o;return n?i.createElement(m,a(a({ref:t},p),{},{components:n})):i.createElement(m,a({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,a[1]=s;for(var l=2;l<o;l++)a[l]=n[l];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},5145:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return c},toc:function(){return l},default:function(){return u}});var i=n(7462),r=n(3366),o=(n(7294),n(3905)),a=["components"],s={sidebar_position:5},c={unversionedId:"exposing-binding-data/olm-descriptors",id:"exposing-binding-data/olm-descriptors",isDocsHomePage:!1,title:"Adding Binding Metadata as OLM Descriptors",description:"Use this method if your Operator is distributed as an [Operator",source:"@site/docs/exposing-binding-data/olm-descriptors.md",sourceDirName:"exposing-binding-data",slug:"/exposing-binding-data/olm-descriptors",permalink:"/service-binding-documentation/docs/exposing-binding-data/olm-descriptors",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/exposing-binding-data/olm-descriptors.md",version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Adding Binding Metadata as Annotations",permalink:"/service-binding-documentation/docs/exposing-binding-data/adding-annotation"},next:{title:"Detect Bindings through owned resources",permalink:"/service-binding-documentation/docs/exposing-binding-data/detect-bindings"}},l=[{value:"Example: X-Descriptor definition for the path pointing to a Secret service resource",id:"example-x-descriptor-definition-for-the-path-pointing-to-a-secret-service-resource",children:[]},{value:"Exposing an entire Secret as the binding Secret",id:"exposing-an-entire-secret-as-the-binding-secret",children:[{value:"Example: Configuration with a urn:alm:descriptor:io.kubernetes:Secret entry",id:"example-configuration-with-a-urnalmdescriptoriokubernetessecret-entry",children:[]}]},{value:"Exposing an entire ConfigMap as the binding Secret",id:"exposing-an-entire-configmap-as-the-binding-secret",children:[{value:"Example: Configuration with a urn:alm:descriptor:io.kubernetes:ConfigMap entry",id:"example-configuration-with-a-urnalmdescriptoriokubernetesconfigmap-entry",children:[]}]},{value:"Exposing an entry from a ConfigMap into the binding Secret",id:"exposing-an-entry-from-a-configmap-into-the-binding-secret",children:[{value:"Example: Configuration with a urn:alm:descriptor:io.kubernetes:ConfigMap entry",id:"example-configuration-with-a-urnalmdescriptoriokubernetesconfigmap-entry-1",children:[]}]},{value:"Exposing an entry from a Secret into the binding Secret",id:"exposing-an-entry-from-a-secret-into-the-binding-secret",children:[{value:"Example: Configuration with a urn:alm:descriptor:io.kubernetes:Secret entry",id:"example-configuration-with-a-urnalmdescriptoriokubernetessecret-entry-1",children:[]}]},{value:"Exposing a resource definition value into the binding Secret",id:"exposing-a-resource-definition-value-into-the-binding-secret",children:[{value:"Example: The connectionURL attribute pointing to the uri value",id:"example-the-connectionurl-attribute-pointing-to-the-uri-value",children:[]}]},{value:"Exposing the entries of a collection into the binding Secret selecting the key and value from each entry",id:"exposing-the-entries-of-a-collection-into-the-binding-secret-selecting-the-key-and-value-from-each-entry",children:[{value:"Example: Configuration from a backing service resource",id:"example-configuration-from-a-backing-service-resource",children:[]},{value:"Example: Configuration for the required entries of a collection",id:"example-configuration-for-the-required-entries-of-a-collection",children:[]}]},{value:"Exposing the items of a collection into the binding Secret with one key per item",id:"exposing-the-items-of-a-collection-into-the-binding-secret-with-one-key-per-item",children:[{value:"Example: Configuration from a backing service resource",id:"example-configuration-from-a-backing-service-resource-1",children:[]},{value:"Example: Configuration for the required items of a collection",id:"example-configuration-for-the-required-items-of-a-collection",children:[]}]},{value:"Exposing the values of collection entries into the binding Secret with one key per entry value",id:"exposing-the-values-of-collection-entries-into-the-binding-secret-with-one-key-per-entry-value",children:[{value:"Example: Configuration from a backing service resource",id:"example-configuration-from-a-backing-service-resource-2",children:[]},{value:"Example: Configuration for the required values of collection entries",id:"example-configuration-for-the-required-values-of-collection-entries",children:[]}]}],p={toc:l};function u(e){var t=e.components,n=(0,r.Z)(e,a);return(0,o.kt)("wrapper",(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Use this method if your Operator is distributed as an ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/operator-framework/operator-registry/blob/master/docs/design/operator-bundle.md"},"Operator\nBundle"),".\nYou can add ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/openshift/console/blob/master/frontend/packages/operator-lifecycle-manager/src/components/descriptors/reference/reference.md"},"OLM\ndescriptors"),"\nto describe the binding metadata that is to be exposed.  The OLM\ndescriptors are part of ",(0,o.kt)("a",{parentName:"p",href:"https://docs.openshift.com/container-platform/4.7/operators/operator_sdk/osdk-generating-csvs.html"},"Cluster Service\nVersion"),"\nfiles.  You can expose the binding data by using ",(0,o.kt)("inlineCode",{parentName:"p"},"specDescriptors")," array and\nStatusDescriptors.  The ",(0,o.kt)("inlineCode",{parentName:"p"},"specDescriptors")," array specifies a path under the\n",(0,o.kt)("inlineCode",{parentName:"p"},".spec")," section of a custom resource.  The ",(0,o.kt)("inlineCode",{parentName:"p"},"statusDescriptors")," array specifies a\npath under the ",(0,o.kt)("inlineCode",{parentName:"p"},".status")," section of a custom resource."),(0,o.kt)("p",null,"The Service Binding Operator detects the OLM descriptors.  Then the Service\nBinding will create a Secret with the values extracted based on the same.\nFinally the Service Binding will project the values into the application."),(0,o.kt)("p",null,"Following are the only two fields that are used for binding the metadata:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Path: A dot-delimited path of the field on the object as described by the\ndescriptor."),(0,o.kt)("li",{parentName:"ul"},"X-Descriptors: Defines the binding metadata.")),(0,o.kt)("p",null,"The following examples show how to define an X-Descriptor depending on the\nresource to which you point the path:"),(0,o.kt)("h2",{id:"example-x-descriptor-definition-for-the-path-pointing-to-a-secret-service-resource"},"Example: X-Descriptor definition for the path pointing to a Secret service resource"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"urn:alm:descriptor:io.kubernetes:Secret\n")),(0,o.kt)("p",null,"Similary, if the path is pointing to a `ConfigMap** resource, there should be an\nX-Descriptors defined like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"urn:alm:descriptor:io.kubernetes:ConfigMap\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"You must have a ",(0,o.kt)("inlineCode",{parentName:"li"},"service.binding")," entry in the X-Descriptors to identify that\nit is a configuration for service binding."),(0,o.kt)("li",{parentName:"ul"},"Absence of the ",(0,o.kt)("inlineCode",{parentName:"li"},"Secret")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"ConfigMap")," specific X-Descriptors indicates that\nthe descriptor is referencing the binding metadata value at the given path.")),(0,o.kt)("h2",{id:"exposing-an-entire-secret-as-the-binding-secret"},"Exposing an entire Secret as the binding Secret"),(0,o.kt)("p",null,"If you are projecting all the values from a ",(0,o.kt)("inlineCode",{parentName:"p"},"Secret")," service resource, you must\nspecify it as an attribute in the backing service custom resource. For example,\nif the attribute is part of the ",(0,o.kt)("inlineCode",{parentName:"p"},".spec")," section, you can create and use a\n",(0,o.kt)("inlineCode",{parentName:"p"},"specDescriptors")," array. Or, if the attribute is part of the ",(0,o.kt)("inlineCode",{parentName:"p"},".status")," section,\nyou can create and use a ",(0,o.kt)("inlineCode",{parentName:"p"},"statusDescriptors")," array."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, create an entry to indicate that the path points\nto the ",(0,o.kt)("inlineCode",{parentName:"li"},"Secret")," service resource.")),(0,o.kt)("h3",{id:"example-configuration-with-a-urnalmdescriptoriokubernetessecret-entry"},"Example: Configuration with a urn:alm:descriptor:io.kubernetes:Secret entry"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: data.dbCredentials\n  x-descriptors:\n  - urn:alm:descriptor:io.kubernetes:Secret\n  - service.binding\n")),(0,o.kt)("h2",{id:"exposing-an-entire-configmap-as-the-binding-secret"},"Exposing an entire ConfigMap as the binding Secret"),(0,o.kt)("p",null,"If you are projecting all the values from a ",(0,o.kt)("inlineCode",{parentName:"p"},"ConfigMap")," service resource, you\nmust specify it as an attribute in the backing service custom resource. For\nexample, if the attribute is part of the ",(0,o.kt)("inlineCode",{parentName:"p"},".spec")," section, you can create and use\na ",(0,o.kt)("inlineCode",{parentName:"p"},"specDescriptors")," array. Or, if the attribute is part of the ",(0,o.kt)("inlineCode",{parentName:"p"},".status"),"\nsection, you can create and use a ",(0,o.kt)("inlineCode",{parentName:"p"},"statusDescriptors")," array."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, create an entry to indicate that the path points\nto the ",(0,o.kt)("inlineCode",{parentName:"li"},"ConfigMap")," service resource.")),(0,o.kt)("h3",{id:"example-configuration-with-a-urnalmdescriptoriokubernetesconfigmap-entry"},"Example: Configuration with a urn:alm:descriptor:io.kubernetes:ConfigMap entry"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: data.dbConfiguration\n  x-descriptors:\n  - urn:alm:descriptor:io.kubernetes:ConfigMap\n  - service.binding\n")),(0,o.kt)("h2",{id:"exposing-an-entry-from-a-configmap-into-the-binding-secret"},"Exposing an entry from a ConfigMap into the binding Secret"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, update ",(0,o.kt)("inlineCode",{parentName:"li"},"X-Descriptors")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"service.binding")," and\n",(0,o.kt)("inlineCode",{parentName:"li"},"sourceKey")," by providing the following information:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"name of the binding key that is to be projected"),(0,o.kt)("li",{parentName:"ul"},"name of the key in the Secret service resource")),(0,o.kt)("h3",{id:"example-configuration-with-a-urnalmdescriptoriokubernetesconfigmap-entry-1"},"Example: Configuration with a urn:alm:descriptor:io.kubernetes:ConfigMap entry"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: data.dbConfiguration\n  x-descriptors:\n  - urn:alm:descriptor:io.kubernetes:ConfigMap\n  - service.binding:my_certificate:sourceKey=certificate\n")),(0,o.kt)("p",null,"In the previous example, ",(0,o.kt)("inlineCode",{parentName:"p"},"sourceKey")," points to the name of the key in the Secret\nresource, which is ",(0,o.kt)("inlineCode",{parentName:"p"},"certificate"),".  And ",(0,o.kt)("inlineCode",{parentName:"p"},"my_certificate")," is the name of the\nbinding key that is going to be projected."),(0,o.kt)("h2",{id:"exposing-an-entry-from-a-secret-into-the-binding-secret"},"Exposing an entry from a Secret into the binding Secret"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, update ",(0,o.kt)("inlineCode",{parentName:"li"},"X-Descriptors")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"service.binding")," and\n",(0,o.kt)("inlineCode",{parentName:"li"},"sourceKey")," by providing the following information:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"name of the binding key that is to be projected"),(0,o.kt)("li",{parentName:"ul"},"name of the key in the Secret service resource")),(0,o.kt)("h3",{id:"example-configuration-with-a-urnalmdescriptoriokubernetessecret-entry-1"},"Example: Configuration with a urn:alm:descriptor:io.kubernetes:Secret entry"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: data.dbConfiguration\n  x-descriptors:\n  - urn:alm:descriptor:io.kubernetes:Secret\n  - service.binding:my_certificate:sourceKey=certificate\n")),(0,o.kt)("p",null,"In the previous example, ",(0,o.kt)("inlineCode",{parentName:"p"},"sourceKey")," points to the name of the key in the Secret\nresource, which is ",(0,o.kt)("inlineCode",{parentName:"p"},"certificate"),".  And ",(0,o.kt)("inlineCode",{parentName:"p"},"my_certificate")," is the name of the\nbinding key that is going to be projected."),(0,o.kt)("h2",{id:"exposing-a-resource-definition-value-into-the-binding-secret"},"Exposing a resource definition value into the binding Secret"),(0,o.kt)("p",null,"If values required for binding to the backing service are available as\nattributes of its resources, you can annotate these values, using\n",(0,o.kt)("inlineCode",{parentName:"p"},"X-Descriptors"),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Annotating the values identifies them as the binding metadata."),(0,o.kt)("li",{parentName:"ul"},"Content for Procedure: ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, update ",(0,o.kt)("inlineCode",{parentName:"li"},"X-Descriptors")," with the required resource definition value.")),(0,o.kt)("h3",{id:"example-the-connectionurl-attribute-pointing-to-the-uri-value"},"Example: The connectionURL attribute pointing to the uri value"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: data.connectionURL\n  x-descriptors:\n  - service.binding:uri\n")),(0,o.kt)("p",null,"In the previous example, the ",(0,o.kt)("inlineCode",{parentName:"p"},"connectionURL")," attribute points to the required\nvalue that is to be projected as ",(0,o.kt)("inlineCode",{parentName:"p"},"uri"),"."),(0,o.kt)("h2",{id:"exposing-the-entries-of-a-collection-into-the-binding-secret-selecting-the-key-and-value-from-each-entry"},"Exposing the entries of a collection into the binding Secret selecting the key and value from each entry"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Content for Procedure: ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, update ",(0,o.kt)("inlineCode",{parentName:"li"},"X-Descriptors")," for the required entries of a collection.")),(0,o.kt)("h3",{id:"example-configuration-from-a-backing-service-resource"},"Example: Configuration from a backing service resource"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"status:\n  connections:\n    - type: primary\n      url: primary.example.com\n    - type: secondary\n      url: secondary.example.com\n    - type: '404'\n      url: black-hole.example.com\n")),(0,o.kt)("p",null,"The previous example helps you to project all those values with key such as ",(0,o.kt)("inlineCode",{parentName:"p"},"primary"),",\n",(0,o.kt)("inlineCode",{parentName:"p"},"secondary"),", and so on."),(0,o.kt)("h3",{id:"example-configuration-for-the-required-entries-of-a-collection"},"Example: Configuration for the required entries of a collection"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: bootstrap\n  x-descriptors:\n  - service.binding:endpoints:elementType=sliceOfMaps:sourceKey=type:sourceValue=url\n")),(0,o.kt)("h2",{id:"exposing-the-items-of-a-collection-into-the-binding-secret-with-one-key-per-item"},"Exposing the items of a collection into the binding Secret with one key per item"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Content for Procedure: ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, update ",(0,o.kt)("inlineCode",{parentName:"li"},"X-Descriptors")," for the required items of a collection.")),(0,o.kt)("h3",{id:"example-configuration-from-a-backing-service-resource-1"},"Example: Configuration from a backing service resource"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"spec:\n    tags:\n      - knowledge\n      - is\n      - power\n")),(0,o.kt)("p",null,"The previous example helps you project all those values with key such as\n",(0,o.kt)("inlineCode",{parentName:"p"},"prefix_0"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"prefix_1"),", and so on.  The default prefix is the name of the\nresource kind:"),(0,o.kt)("h3",{id:"example-configuration-for-the-required-items-of-a-collection"},"Example: Configuration for the required items of a collection"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: spec.tags\n  x-descriptors:\n  - service.binding:tags:elementType=sliceOfStrings\n")),(0,o.kt)("h2",{id:"exposing-the-values-of-collection-entries-into-the-binding-secret-with-one-key-per-entry-value"},"Exposing the values of collection entries into the binding Secret with one key per entry value"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Content for Procedure: ")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Using the ",(0,o.kt)("inlineCode",{parentName:"li"},"path")," attribute, update ",(0,o.kt)("inlineCode",{parentName:"li"},"X-Descriptors")," for the required values of collection entries.")),(0,o.kt)("h3",{id:"example-configuration-from-a-backing-service-resource-2"},"Example: Configuration from a backing service resource"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"spec:\n    connections:\n      - type: primary\n        url: primary.example.com\n      - type: secondary\n        url: secondary.example.com\n      - type: '404'\n        url: black-hole.example.com\n")),(0,o.kt)("p",null,"The previous example helps you project all those values with key such as\n",(0,o.kt)("inlineCode",{parentName:"p"},"prefix_0"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"prefix_1"),", and so on.  The default prefix is the name of the\nresource kind:"),(0,o.kt)("h3",{id:"example-configuration-for-the-required-values-of-collection-entries"},"Example: Configuration for the required values of collection entries"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- path: bootstrap\n  x-descriptors:\n  - service.binding:endpoints:elementType=sliceOfStrings:sourceValue=url\n")))}u.isMDXComponent=!0}}]);